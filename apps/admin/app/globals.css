@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Industrial Terminal - Light Mode Design System (default) */
    /* Background hierarchy:
       - Use a slightly darker app background
       - Use pure white for elevated surfaces (cards/tables) for readability */
    --bg: 244 244 245; /* zinc-100 */
    --bg-elevated: 255 255 255; /* white */
    --bg-sunken: 228 228 231; /* zinc-200 */

    /* Foreground: near-black for readability on light */
    --fg: 24 24 27; /* zinc-900 */
    --fg-muted: 39 39 42; /* zinc-800 */
    --fg-subtle: 82 82 91; /* zinc-600 */

    /* Border: subtle definition */
    --border: 212 212 216; /* zinc-300 */
    --border-subtle: 228 228 231; /* zinc-200 */
    --border-strong: 161 161 170; /* zinc-400 */

    /* Primary accent: Industrial Sky */
    --primary: 14 165 233; /* sky-500 */
    --primary-fg: 0 0 0;   /* black on sky */
    --primary-dim: 3 105 161; /* sky-700: hover states */
    --primary-glow: 14 165 233; /* for shadows */

    /* Status colors: functional but muted */
    --success: 34 197 94;  /* green-500 */
    --success-fg: 0 0 0;
    /* Warning should stand out but we avoid yellow/orange per preference; use cyan. */
    --warning: 34 211 238; /* cyan-400 */
    --warning-fg: 0 0 0;
    --danger: 239 68 68;   /* red-500 */
    --danger-fg: 255 255 255;
    --info: 59 130 246;    /* blue-500 */
    --info-fg: 255 255 255;

    /* Terminal-specific */
    --terminal-green: 74 222 128; /* green-400: data accents */
    --terminal-amber: 34 211 238; /* legacy name; maps to warning (cyan) */
    --terminal-cyan: 34 211 238;  /* cyan-400: info */

    /* Ring focus */
    --ring: 14 165 233;    /* sky-500 */
  }

  /*
    Accent Themes
    These are "color themes" that primarily change the primary accent + focus ring.
    Dark/light mode is still controlled by the `.dark` class.
  */
  :root.theme-sky {
    --primary: 14 165 233; /* sky-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 3 105 161; /* sky-700 */
    --primary-glow: 14 165 233;
    --ring: 14 165 233;
  }

  :root.theme-emerald {
    --primary: 16 185 129; /* emerald-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 4 120 87; /* emerald-700 */
    --primary-glow: 16 185 129;
    --ring: 16 185 129;
  }

  :root.theme-teal {
    --primary: 20 184 166; /* teal-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 15 118 110; /* teal-700 */
    --primary-glow: 20 184 166;
    --ring: 20 184 166;
  }

  :root.theme-rose {
    --primary: 244 63 94; /* rose-500 */
    --primary-fg: 255 255 255;
    --primary-dim: 190 18 60; /* rose-700 */
    --primary-glow: 244 63 94;
    --ring: 244 63 94;
  }

  :root.theme-slate {
    --primary: 100 116 139; /* slate-500 */
    --primary-fg: 255 255 255;
    --primary-dim: 51 65 85; /* slate-700 */
    --primary-glow: 100 116 139;
    --ring: 100 116 139;
  }

  .dark {
    /* Industrial Terminal - Dark Mode Design System */
    /* Background hierarchy: darkest at bottom, lighter as we rise */
    --bg: 9 9 11; /* zinc-950 */
    --bg-elevated: 24 24 27; /* zinc-900 */
    --bg-sunken: 0 0 0; /* pure black */

    /* Foreground: warm white for readability on dark */
    --fg: 250 250 250; /* zinc-50 */
    --fg-muted: 161 161 170; /* zinc-400 */
    --fg-subtle: 113 113 122; /* zinc-500 */

    /* Border: subtle definition */
    --border: 63 63 70; /* zinc-700 */
    --border-subtle: 39 39 42; /* zinc-800 */
    --border-strong: 82 82 91; /* zinc-600 */
  }

  * {
    @apply border-border;
  }

  html {
    @apply scroll-smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  html,
  body {
    height: 100%;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: "cv02", "cv03", "cv04", "cv11";
  }

  /* Custom scrollbar for terminal feel */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: rgb(var(--bg-sunken));
  }

  ::-webkit-scrollbar-thumb {
    background: rgb(var(--border));
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgb(var(--border-strong));
  }

  ::selection {
    background: rgba(var(--primary), 0.25);
    color: rgb(var(--fg));
  }

  code {
    @apply font-mono;
  }

  /*
    Readability: avoid dotted/slashed zeros anywhere we use mono (tables, IDs, codes).
    This addresses the “0 with a dot inside” complaint.
  */
  .font-mono {
    font-feature-settings: "zero" 0;
  }
}

@layer components {
  /* Terminal-style data display */
  .data-mono {
    /* Higher weight + a touch of spacing makes dense amounts easier to scan */
    @apply font-mono tabular-nums font-medium tracking-[0.02em];
    font-variant-numeric: tabular-nums;
    /* Avoid dotted/slashed zeros; they hurt scanning in dense tables */
    font-feature-settings: "zero" 0;
  }

  /* Navigation rail item */
  .nav-rail-item {
    @apply relative flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm transition-all duration-200;
    @apply text-fg-muted hover:text-foreground hover:bg-bg-elevated/60;
  }

  .nav-rail-item[data-active="true"] {
    @apply text-primary bg-primary/10;
  }

  .nav-rail-item[data-active="true"]::before {
    content: "";
    @apply absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 bg-primary rounded-r-full;
  }

  /* Form controls - industrial style */
  .ui-control {
    @apply h-10 w-full rounded-md px-3 text-sm transition-all duration-200;
    @apply bg-bg-elevated border border-border text-foreground;
    @apply placeholder:text-fg-subtle;
    @apply focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/20;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  .ui-control-sm {
    @apply h-8 w-full rounded-md px-2.5 text-sm;
    @apply bg-bg-elevated border border-border text-foreground;
    @apply placeholder:text-fg-subtle;
    @apply focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/20;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  .ui-select {
    @apply ui-control pr-10 appearance-none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='rgb(161,161,170)' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: calc(100% - 0.75rem) center;
  }

  .ui-textarea {
    @apply w-full rounded-md px-3 py-2 text-sm min-h-[80px];
    @apply bg-bg-elevated border border-border text-foreground;
    @apply placeholder:text-fg-subtle;
    @apply focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/20;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* Checkbox - industrial toggle style */
  .ui-checkbox {
    @apply h-4 w-4 rounded border border-border-strong bg-bg-elevated;
    @apply text-primary focus:ring-primary/20 focus:ring-offset-0;
    @apply transition-colors;
  }

  /* Table styling - data terminal aesthetic */
  .ui-table-wrap {
    /* Tables are dense: keep them crisp and high-contrast. */
    @apply relative overflow-auto rounded-lg border border-border bg-bg-elevated;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03);
  }

  .ui-table {
    @apply w-full text-left text-sm;
    font-variant-numeric: tabular-nums;
    font-feature-settings: "zero" 0;
  }

  /* Enhanced table readability (applies to all ui-table inside ui-table-wrap) */
  .ui-table-wrap .ui-table thead th {
    @apply sticky top-0 z-10 bg-bg-elevated;
  }

  .ui-table-wrap .ui-table tbody tr:nth-child(even) {
    background: rgba(var(--bg-sunken), 0.22);
  }

  .ui-thead {
    /* Slightly larger + darker header text improves scan-ability. */
    @apply text-[11px] font-semibold uppercase tracking-wider text-fg-muted;
    @apply bg-bg-elevated border-b border-border-subtle;
  }

  .ui-thead th {
    @apply py-3 px-4 font-medium;
  }

  .ui-tr {
    @apply border-b border-border-subtle transition-colors;
  }

  .ui-tr-hover {
    @apply hover:bg-bg-sunken/60;
  }

  .ui-table td {
    /* Higher contrast makes dense tables easier to scan */
    @apply py-3 px-4 text-foreground;
  }

  /* Subtle data tinting for faster scanning (tables only).
     We keep it neutral so feature-specific accents (USD/LBP/status) can override cleanly. */
  .ui-table td.data-mono,
  .ui-table td .data-mono {
    color: rgb(var(--fg-muted));
  }

  /* Optional semantic accents (keep subtle; used intentionally in tables). */
  .ui-tone-usd {
    color: rgb(var(--info));
  }

  .ui-tone-lbp {
    color: rgb(var(--warning));
  }

  .ui-tone-qty {
    color: rgb(var(--success));
  }

  .ui-tone-negative {
    color: rgb(var(--danger));
  }

  .ui-table tbody tr:last-child {
    @apply border-b-0;
  }

  /* Date inputs: make calendar pickers feel consistent and readable */
  input[type="date"] {
    @apply data-mono;
    /* Keep text clear of the native calendar icon (esp. WebKit). */
    padding-right: 2.5rem;
    /* Use our own calendar glyph so date inputs look consistent across pages/browsers. */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='rgb(161,161,170)' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8 2v4'/%3E%3Cpath d='M16 2v4'/%3E%3Crect width='18' height='18' x='3' y='4' rx='2'/%3E%3Cpath d='M3 10h18'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: calc(100% - 0.75rem) center;
  }

  /* WebKit: normalize date field text color/spacing across pages */
  input[type="date"]::-webkit-datetime-edit {
    color: rgb(var(--fg));
  }

  input[type="date"]::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }

  input[type="date"]::-webkit-inner-spin-button,
  input[type="date"]::-webkit-clear-button {
    display: none;
  }

  input[type="date"]::-webkit-calendar-picker-indicator {
    /* Keep the click target, but hide the inconsistent native icon (we render our own). */
    opacity: 0;
    cursor: pointer;
  }

  input[type="date"]:hover::-webkit-calendar-picker-indicator,
  input[type="date"]:focus-visible::-webkit-calendar-picker-indicator {
    opacity: 0;
  }

  /* When we render a custom calendar icon button, hide the native indicator (to avoid double icons). */
  input[type="date"].ui-date::-webkit-calendar-picker-indicator {
    opacity: 0;
  }

  input[type="date"].ui-date {
    background-image: none;
  }

  /* Keyboard shortcuts */
  .ui-kbd {
    @apply inline-flex items-center justify-center rounded px-1.5 py-0.5 text-[11px] font-mono font-medium;
    @apply bg-bg-elevated text-fg-muted border border-border;
    box-shadow: 0 1px 0 rgb(var(--border-strong));
  }

  /* Chips/Tags */
  .ui-chip {
    @apply inline-flex items-center gap-1.5 rounded-md px-2.5 py-1 text-xs font-medium;
  }

  .ui-chip-default {
    @apply bg-bg-elevated text-fg-muted border border-border;
  }

  .ui-chip-primary {
    @apply bg-primary/10 text-primary border border-primary/20;
  }

  .ui-chip-success {
    @apply bg-success/10 text-success border border-success/20;
  }

  .ui-chip-warning {
    @apply bg-warning/10 text-warning border border-warning/20;
  }

  .ui-chip-danger {
    @apply bg-danger/10 text-danger border border-danger/20;
  }

  /* Status indicators */
  .status-dot {
    @apply h-2 w-2 rounded-full;
  }

  .status-online {
    @apply bg-success;
    box-shadow: 0 0 8px rgb(var(--success) / 0.45);
  }

  .status-offline {
    @apply bg-danger;
  }

  .status-warning {
    @apply bg-warning;
  }

  /* Section dividers */
  .section-divider {
    @apply h-px bg-gradient-to-r from-transparent via-border-strong to-transparent;
  }

  /* Glass panel for overlays */
  .glass-panel {
    @apply bg-bg-elevated/80 backdrop-blur-xl border border-border-subtle;
  }

  /* Data grid cells */
  .data-cell {
    @apply data-mono text-fg-muted;
  }

  .data-cell-positive {
    @apply text-success;
  }

  .data-cell-negative {
    @apply text-danger;
  }

  .data-cell-highlight {
    @apply text-primary;
  }

  /* Card variations */
  .card-interactive {
    @apply transition-all duration-200;
    @apply hover:border-border-strong hover:shadow-lg hover:shadow-black/10;
  }
}

@layer utilities {
  /*
    Token Compatibility Shim
    Some pages still use hardcoded Tailwind slate/white utilities. Override the most common ones
    so they follow our design tokens and stay correct in dark mode.
  */

  /* Backgrounds */
  .bg-white {
    background-color: rgb(var(--bg-elevated));
  }
  .bg-white\/60 {
    background-color: rgb(var(--bg-elevated) / 0.6);
  }
  .bg-white\/80 {
    background-color: rgb(var(--bg-elevated) / 0.8);
  }

  .bg-slate-50 {
    background-color: rgb(var(--bg-sunken) / 0.35);
  }
  .bg-slate-100 {
    background-color: rgb(var(--bg-sunken) / 0.55);
  }

  .hover\:bg-slate-50:hover {
    background-color: rgb(var(--bg-sunken) / 0.45);
  }

  /* Borders */
  .border-slate-100 {
    border-color: rgb(var(--border-subtle));
  }
  .border-slate-200 {
    border-color: rgb(var(--border-subtle));
  }
  .border-slate-300 {
    border-color: rgb(var(--border));
  }

  /* Text */
  .text-slate-950,
  .text-slate-900,
  .text-slate-800 {
    color: rgb(var(--fg));
  }
  .text-slate-700,
  .text-slate-600 {
    color: rgb(var(--fg-muted));
  }
  .text-slate-500,
  .text-slate-400 {
    color: rgb(var(--fg-subtle));
  }
}

@layer utilities {
  /* Animation utilities */
  .animate-fade-in {
    animation: fadeIn 0.2s ease-out;
  }

  .animate-slide-in-right {
    animation: slideInRight 0.2s ease-out;
  }

  .animate-pulse-subtle {
    animation: pulseSubtle 2s ease-in-out infinite;
  }

  /* Text utilities */
  .text-balance {
    text-wrap: balance;
  }

  /* Gradient text */
  .text-gradient {
    @apply bg-gradient-to-r from-primary to-primary-dim bg-clip-text text-transparent;
  }

  /* Focus ring */
  .focus-ring {
    @apply focus:outline-none focus:ring-2 focus:ring-primary/30 focus:ring-offset-2 focus:ring-offset-background;
  }

  /* Links that should look like "actions" in dense tables/forms */
  .ui-link {
    @apply relative inline-flex items-center gap-1 text-primary underline-offset-4 hover:underline focus-ring;
  }

  /* "Shortcut" links: look like normal text until hover/focus, then show link styling + arrow. */
  .ui-shortcut {
    @apply relative inline-flex items-center gap-1 rounded-sm px-1 -mx-1 text-foreground underline-offset-4 hover:text-primary hover:underline focus-ring;
  }

  /* Hover affordance: arrow appears only on hover/focus (keep the UI calm by default). */
  .ui-link::after,
  .ui-shortcut::after {
    content: "\\2192";
    display: inline-block;
    /* Reserve space to avoid layout shift on hover, but keep it in-flow so it can't overlap text. */
    width: 1.1em;
    margin-left: 0.25rem;
    text-align: center;
    opacity: 0;
    transform: translateX(-2px);
    transition:
      opacity 150ms ease,
      transform 150ms ease;
    pointer-events: none;
  }

  .ui-link:hover::after,
  .ui-link:focus-visible::after,
  .ui-shortcut:hover::after,
  .ui-shortcut:focus-visible::after {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ------------------------------------------------------------
   Print / PDF (browser print dialog)
   ------------------------------------------------------------ */

/* Use on elements that should never appear in print/PDF. */
@media print {
  .no-print {
    display: none !important;
  }

  /* Force a neutral paper look even if the UI is in dark mode. */
  html,
  body {
    background: #fff !important;
    color: #000 !important;
  }

  /* Links should not show as blue/underlined on official documents. */
  a {
    color: inherit !important;
    text-decoration: none !important;
  }

  /* Make table headers repeat across pages. */
  thead {
    display: table-header-group;
  }
  tfoot {
    display: table-footer-group;
  }
}

/* Default page settings (most printers support A4; browsers will map if needed). */
@page {
  size: A4;
  margin: 12mm;
}

/* Use for the paper container (works both on-screen and in print). */
.print-paper {
  background: #fff;
  color: #000;
}

@keyframes pulseSubtle {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}
