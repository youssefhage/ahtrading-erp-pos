@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Industrial Terminal - Light Mode Design System (default) */
    /* Background hierarchy:
       - Use a slightly darker app background
       - Use pure white for elevated surfaces (cards/tables) for readability */
    --bg: 244 244 245; /* zinc-100 */
    --bg-elevated: 255 255 255; /* white */
    --bg-sunken: 228 228 231; /* zinc-200 */
    --table-head-bg: 242 242 244; /* subtle light grey for table headers */

    /* Foreground: near-black for readability on light */
    --fg: 24 24 27; /* zinc-900 */
    --fg-muted: 39 39 42; /* zinc-800 */
    --fg-subtle: 82 82 91; /* zinc-600 */

    /* Border: subtle definition */
    --border: 212 212 216; /* zinc-300 */
    --border-subtle: 228 228 231; /* zinc-200 */
    --border-strong: 161 161 170; /* zinc-400 */

    /* Primary accent: Admin Cobalt (default) */
    --primary: 37 99 235; /* blue-600 */
    --primary-fg: 255 255 255;
    --primary-dim: 29 78 216; /* blue-700 */
    --primary-glow: 37 99 235; /* for shadows */

    /* Status colors tuned for accessible contrast on light surfaces. */
    --success: 21 128 61;  /* green-700 */
    --success-fg: 255 255 255;
    /* Warning and danger stay in red family per UI legend. */
    --warning: 220 38 38;  /* red-600 */
    --warning-fg: 255 255 255;
    --danger: 153 27 27;   /* red-800 */
    --danger-fg: 255 255 255;
    --info: 29 78 216;     /* blue-700 */
    --info-fg: 255 255 255;

    /* Terminal-specific */
    --terminal-green: 21 128 61;  /* green-700: data accents */
    --terminal-amber: 220 38 38;  /* legacy name; maps to warning (red) */
    --terminal-cyan: 34 211 238;  /* cyan-400: info */

    /* Ring focus */
    --ring: 37 99 235;    /* blue-600 */

    /* Text selection (subtle light grey) */
    --selection: 0 0 0;
    --selection-alpha: 0.08;
  }

  /*
    Accent Themes
    These are "color themes" that primarily change the primary accent + focus ring.
    Dark/light mode is still controlled by the `.dark` class.
  */
  :root.theme-sky {
    --primary: 14 165 233; /* sky-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 3 105 161; /* sky-700 */
    --primary-glow: 14 165 233;
    --ring: 14 165 233;
  }

  :root.theme-cobalt {
    --primary: 37 99 235; /* blue-600 */
    --primary-fg: 255 255 255;
    --primary-dim: 29 78 216; /* blue-700 */
    --primary-glow: 37 99 235;
    --ring: 37 99 235;
  }

  :root.theme-emerald {
    --primary: 16 185 129; /* emerald-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 4 120 87; /* emerald-700 */
    --primary-glow: 16 185 129;
    --ring: 16 185 129;
  }

  :root.theme-teal {
    --primary: 20 184 166; /* teal-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 15 118 110; /* teal-700 */
    --primary-glow: 20 184 166;
    --ring: 20 184 166;
  }

  :root.theme-rose {
    --primary: 244 63 94; /* rose-500 */
    --primary-fg: 255 255 255;
    --primary-dim: 190 18 60; /* rose-700 */
    --primary-glow: 244 63 94;
    --ring: 244 63 94;
  }

  :root.theme-slate {
    --primary: 100 116 139; /* slate-500 */
    --primary-fg: 255 255 255;
    --primary-dim: 51 65 85; /* slate-700 */
    --primary-glow: 100 116 139;
    --ring: 100 116 139;
  }

  /*
    Accent Themes
    These are "color themes" that primarily change the primary accent + focus ring.
    Dark/light mode is still controlled by the `.dark` class.
  */
  :root.theme-sky {
    --primary: 14 165 233; /* sky-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 3 105 161; /* sky-700 */
    --primary-glow: 14 165 233;
    --ring: 14 165 233;
  }

  :root.theme-emerald {
    --primary: 16 185 129; /* emerald-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 4 120 87; /* emerald-700 */
    --primary-glow: 16 185 129;
    --ring: 16 185 129;
  }

  :root.theme-teal {
    --primary: 20 184 166; /* teal-500 */
    --primary-fg: 0 0 0;
    --primary-dim: 15 118 110; /* teal-700 */
    --primary-glow: 20 184 166;
    --ring: 20 184 166;
  }

  :root.theme-rose {
    --primary: 244 63 94; /* rose-500 */
    --primary-fg: 255 255 255;
    --primary-dim: 190 18 60; /* rose-700 */
    --primary-glow: 244 63 94;
    --ring: 244 63 94;
  }

  :root.theme-slate {
    --primary: 100 116 139; /* slate-500 */
    --primary-fg: 255 255 255;
    --primary-dim: 51 65 85; /* slate-700 */
    --primary-glow: 100 116 139;
    --ring: 100 116 139;
  }

  .dark {
    /* Industrial Terminal - Dark Mode Design System */
    /* Background hierarchy: darkest at bottom, lighter as we rise */
    --bg: 9 9 11; /* zinc-950 */
    --bg-elevated: 24 24 27; /* zinc-900 */
    --bg-sunken: 0 0 0; /* pure black */
    --table-head-bg: 39 39 42; /* subtle grey header contrast in dark mode */

    /* Foreground: warm white for readability on dark */
    --fg: 250 250 250; /* zinc-50 */
    --fg-muted: 161 161 170; /* zinc-400 */
    --fg-subtle: 113 113 122; /* zinc-500 */

    /* Border: subtle definition */
    --border: 63 63 70; /* zinc-700 */
    --border-subtle: 39 39 42; /* zinc-800 */
    --border-strong: 82 82 91; /* zinc-600 */

    /* Status colors tuned for accessible contrast on dark surfaces. */
    --success: 34 197 94; /* green-500 */
    --success-fg: 0 0 0;
    --warning: 248 113 113; /* red-400 */
    --warning-fg: 0 0 0;
    --danger: 239 68 68; /* red-500 */
    --danger-fg: 0 0 0;
    --info: 96 165 250; /* blue-400 */
    --info-fg: 0 0 0;

    --terminal-green: 34 197 94;
    --terminal-amber: 248 113 113;
    --terminal-cyan: 96 165 250;

    /* Text selection (subtle light grey) */
    --selection: 255 255 255;
    --selection-alpha: 0.12;
  }

  * {
    @apply border-border;
  }

  html {
    @apply scroll-smooth;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  html,
  body {
    height: 100%;
  }

  body {
    @apply bg-background text-foreground;
    font-feature-settings: "cv02", "cv03", "cv04", "cv11";
  }

  /* Custom scrollbar for terminal feel */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: rgb(var(--bg-sunken));
  }

  ::-webkit-scrollbar-thumb {
    background: rgb(var(--border));
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgb(var(--border-strong));
  }

  ::selection {
    background: rgba(var(--selection), var(--selection-alpha));
    color: rgb(var(--fg));
  }

  ::-moz-selection {
    background: rgba(var(--selection), var(--selection-alpha));
    color: rgb(var(--fg));
  }

  code {
    @apply font-mono;
  }

  /*
    Readability: avoid dotted/slashed zeros anywhere we use mono (tables, IDs, codes).
    This addresses the “0 with a dot inside” complaint.
  */
  .font-mono {
    font-feature-settings: "tnum" 1, "lnum" 1, "zero" 0;
    font-variant-numeric: tabular-nums lining-nums;
  }
}

@layer components {
  /* Terminal-style data display */
  .data-mono {
    /* Use Roboto for better digit legibility while keeping aligned columns. */
    @apply font-sans tabular-nums font-semibold tracking-[0.01em];
    font-variant-numeric: tabular-nums lining-nums;
    font-feature-settings: "tnum" 1, "lnum" 1, "zero" 0;
  }

  /* Polished surface for “cards inside cards” and dense summaries. */
  .ui-panel {
    @apply rounded-xl border border-border-subtle bg-bg-elevated;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03), 0 10px 24px rgba(0, 0, 0, 0.06);
  }

  .ui-panel-title {
    @apply text-xs font-semibold uppercase tracking-[0.14em] text-fg-subtle;
  }

  .ui-panel-value {
    @apply text-base font-semibold text-foreground;
  }

  .ui-panel-value-mono {
    @apply data-mono text-sm text-foreground;
  }

  /* Key-value rows for dense summaries (invoice totals, document meta, etc.) */
  .ui-kv {
    @apply flex items-center justify-between gap-3 text-sm;
  }

  .ui-kv-label {
    @apply text-fg-subtle;
  }

  .ui-kv-value {
    @apply data-mono text-foreground;
  }

  .ui-kv-strong .ui-kv-label {
    @apply text-foreground font-medium;
  }

  .ui-kv-strong .ui-kv-value {
    @apply text-foreground font-semibold;
  }

  .ui-kv-sub {
    @apply text-xs text-fg-muted;
  }

  /* Shared detail-page outline (Sales/Purchasing/Accounting) */
  .ui-detail-shell {
    @apply mx-auto max-w-6xl space-y-5;
  }

  .ui-detail-shell-wide {
    @apply mx-auto max-w-7xl space-y-5;
  }

  .ui-detail-header {
    @apply rounded-xl border border-border-subtle bg-bg-elevated px-4 py-4 md:px-5;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03), 0 10px 24px rgba(0, 0, 0, 0.06);
  }

  .ui-detail-header-row {
    @apply flex flex-wrap items-start justify-between gap-3;
  }

  .ui-detail-title {
    @apply text-xl font-semibold tracking-tight text-foreground md:text-2xl;
  }

  .ui-detail-subtitle {
    @apply text-sm leading-relaxed text-fg-muted;
  }

  .ui-detail-meta {
    @apply mt-1 flex flex-wrap items-center gap-2 text-sm text-fg-muted;
  }

  .ui-detail-meta-id {
    @apply data-mono text-sm text-foreground;
  }

  .ui-detail-actions {
    @apply flex flex-wrap items-center justify-end gap-2;
  }

  .ui-detail-section {
    @apply rounded-lg border border-border-subtle bg-bg-sunken/20 p-3;
  }

  .ui-detail-section-title {
    @apply text-sm font-semibold text-foreground;
  }

  .ui-detail-section-copy {
    @apply mt-1 text-sm leading-relaxed text-fg-muted;
  }

  /* Shared module/list-page outline */
  .ui-module-shell {
    @apply mx-auto max-w-7xl space-y-5;
  }

  .ui-module-shell-narrow {
    @apply mx-auto max-w-6xl space-y-5;
  }

  .ui-module-head {
    @apply rounded-xl border border-border-subtle bg-bg-elevated px-4 py-4 md:px-5;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03), 0 10px 24px rgba(0, 0, 0, 0.06);
  }

  .ui-module-head-row {
    @apply flex flex-wrap items-start justify-between gap-3;
  }

  .ui-module-kicker {
    @apply text-xs font-semibold uppercase tracking-[0.12em] text-fg-subtle;
  }

  .ui-module-title {
    @apply mt-1 text-xl font-semibold tracking-tight text-foreground md:text-2xl;
  }

  .ui-module-subtitle {
    @apply mt-1 text-sm leading-relaxed text-fg-muted;
  }

  .ui-module-actions {
    @apply flex flex-wrap items-center justify-end gap-2;
  }

  .ui-actions-inline {
    @apply flex flex-wrap items-center justify-end gap-2;
  }

  .ui-actions-between {
    @apply flex flex-wrap items-center justify-between gap-2;
  }

  .ui-form-grid {
    @apply grid grid-cols-1 gap-3;
  }

  .ui-form-grid-2 {
    @apply ui-form-grid md:grid-cols-2;
  }

  .ui-form-grid-3 {
    @apply ui-form-grid md:grid-cols-3;
  }

  .ui-form-grid-4 {
    @apply ui-form-grid md:grid-cols-4;
  }

  .ui-form-grid-6 {
    @apply ui-form-grid md:grid-cols-6;
  }

  .ui-metric-grid {
    @apply grid grid-cols-1 gap-2 md:grid-cols-2;
  }

  .ui-metric {
    @apply rounded-md border border-border bg-bg-elevated p-3;
  }

  .ui-metric-label {
    @apply text-sm text-fg-subtle;
  }

  .ui-metric-value {
    @apply mt-1 data-mono text-sm text-foreground;
  }

  /* Reusable KPI cards (dashboard counters and monetary summaries). */
  .ui-kpi-grid {
    @apply grid grid-cols-1 gap-2 sm:grid-cols-2 lg:grid-cols-3;
  }

  .ui-kpi-grid-dense {
    @apply gap-2 sm:grid-cols-3 xl:grid-cols-6;
  }

  .ui-kpi-card {
    @apply relative overflow-hidden rounded-xl border border-border-subtle bg-bg-elevated px-3 py-3;
    min-height: 92px;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03), 0 10px 22px rgba(0, 0, 0, 0.05);
  }

  .ui-kpi-card::after {
    content: "";
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    height: 2px;
    background: rgb(var(--border-strong) / 0.55);
  }

  .ui-kpi-card[data-tone="info"] {
    border-color: rgb(var(--info) / 0.22);
    background: linear-gradient(180deg, rgb(var(--info) / 0.04) 0%, rgb(var(--bg-elevated)) 60%);
  }

  .ui-kpi-card[data-tone="info"]::after {
    background: rgb(var(--info) / 0.6);
  }

  .ui-kpi-card[data-tone="success"] {
    border-color: rgb(var(--success) / 0.24);
    background: linear-gradient(180deg, rgb(var(--success) / 0.05) 0%, rgb(var(--bg-elevated)) 60%);
  }

  .ui-kpi-card[data-tone="success"]::after {
    background: rgb(var(--success) / 0.6);
  }

  .ui-kpi-card[data-tone="warning"] {
    border-color: rgb(var(--warning) / 0.28);
    background: linear-gradient(180deg, rgb(var(--warning) / 0.06) 0%, rgb(var(--bg-elevated)) 62%);
  }

  .ui-kpi-card[data-tone="warning"]::after {
    background: rgb(var(--warning) / 0.62);
  }

  .ui-kpi-card[data-tone="danger"] {
    border-color: rgb(var(--danger) / 0.3);
    background: linear-gradient(180deg, rgb(var(--danger) / 0.08) 0%, rgb(var(--bg-elevated)) 62%);
  }

  .ui-kpi-card[data-tone="danger"]::after {
    background: rgb(var(--danger) / 0.65);
  }

  .ui-kpi-label {
    @apply text-[12px] font-semibold leading-snug text-fg-muted;
  }

  .ui-kpi-value {
    @apply mt-2 data-mono text-[1.55rem] font-semibold leading-none text-foreground;
  }

  .ui-kpi-subvalue {
    @apply mt-1 data-mono text-[1.15rem] font-semibold leading-tight text-foreground;
  }

  /* Navigation rail item */
  .nav-rail-item {
    @apply relative flex items-center gap-3 rounded-lg px-3 py-2.5 text-sm transition-all duration-200;
    @apply text-fg-muted hover:text-foreground hover:bg-bg-elevated/60;
  }

  .nav-rail-item[data-active="true"] {
    @apply text-primary bg-primary/10;
  }

  .nav-rail-item[data-active="true"]::before {
    content: "";
    @apply absolute left-0 top-1/2 -translate-y-1/2 w-0.5 h-6 bg-primary rounded-r-full;
  }

  /* Form controls - industrial style */
  .ui-control {
    @apply h-10 w-full rounded-md px-3 text-sm transition-all duration-200;
    @apply bg-bg-elevated border border-border text-foreground;
    @apply placeholder:text-fg-subtle;
    @apply focus:outline-none focus:border-primary/60;
    @apply focus-visible:ring-2 focus-visible:ring-primary/35;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  .ui-control-sm {
    @apply h-8 w-full rounded-md px-2.5 text-sm;
    @apply bg-bg-elevated border border-border text-foreground;
    @apply placeholder:text-fg-subtle;
    @apply focus:outline-none focus:border-primary/60;
    @apply focus-visible:ring-2 focus-visible:ring-primary/35;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  .ui-select {
    @apply ui-control pr-10 appearance-none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='rgb(161,161,170)' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: calc(100% - 0.75rem) center;
  }

  .ui-textarea {
    @apply w-full rounded-md px-3 py-2 text-sm min-h-[80px];
    @apply bg-bg-elevated border border-border text-foreground;
    @apply placeholder:text-fg-subtle;
    @apply focus:outline-none focus:border-primary/60;
    @apply focus-visible:ring-2 focus-visible:ring-primary/35;
    @apply disabled:cursor-not-allowed disabled:opacity-50;
  }

  /* Checkbox - industrial toggle style */
  .ui-checkbox {
    appearance: none;
    -webkit-appearance: none;
    @apply inline-grid h-4 w-4 place-content-center rounded border border-border-strong bg-bg-elevated;
    @apply transition-colors;
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/45 focus-visible:ring-offset-1 focus-visible:ring-offset-background;
  }

  .ui-checkbox::before {
    content: "";
    width: 9px;
    height: 9px;
    transform: scale(0);
    transition: transform 120ms ease-in-out;
    background: rgb(var(--primary));
    clip-path: polygon(14% 44%, 0 65%, 42% 100%, 100% 18%, 78% 0, 40% 62%);
  }

  .ui-checkbox:checked {
    @apply border-primary bg-primary;
  }

  .ui-checkbox:checked::before {
    transform: scale(1);
    background: white;
  }

  .ui-checkbox:disabled {
    @apply cursor-not-allowed opacity-50;
  }

  /* Table styling - data terminal aesthetic */
  .ui-table-wrap {
    @apply relative overflow-auto rounded-xl border border-border-subtle bg-bg-elevated;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03), 0 8px 18px rgba(0, 0, 0, 0.05);
  }

  .ui-table-scroll {
    /* Tables are dense: keep them crisp and high-contrast. */
    @apply relative overflow-auto rounded-xl border border-border-subtle bg-bg-elevated;
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.03), 0 8px 18px rgba(0, 0, 0, 0.05);
  }

  .ui-table {
    @apply w-full text-left text-sm;
    font-variant-numeric: tabular-nums lining-nums;
    font-feature-settings: "tnum" 1, "lnum" 1, "zero" 0;
  }

  /* Enhanced table readability (applies to all ui-table inside ui-table-scroll) */
  .ui-table-scroll .ui-table thead th,
  .ui-table-wrap .ui-table thead th {
    @apply sticky top-0 z-10;
    background: rgb(var(--table-head-bg));
  }

  .ui-table-scroll .ui-table tbody tr:nth-child(even),
  .ui-table-wrap .ui-table tbody tr:nth-child(even) {
    background: rgba(var(--bg-sunken), 0.22);
  }

  .ui-thead {
    /* Slightly larger + darker header text improves scan-ability. */
    @apply text-xs font-semibold uppercase tracking-wider text-fg-muted;
    @apply border-b border-border-subtle;
    background: rgb(var(--table-head-bg));
  }

  .ui-thead th {
    @apply py-3 px-4 font-medium;
  }

  .ui-tr {
    @apply border-b border-border-subtle transition-colors;
  }

  .ui-tr-hover {
    @apply hover:bg-bg-sunken/60;
  }

  .ui-tr-focusable {
    @apply focus-visible:outline-none;
  }

  .ui-tr-focusable:focus-visible {
    box-shadow: inset 0 0 0 2px rgb(var(--primary) / 0.45);
    background: rgb(var(--primary) / 0.06);
  }

  .ui-table td {
    /* Higher contrast makes dense tables easier to scan */
    @apply align-top px-4 py-3 leading-relaxed text-foreground;
  }

  /* Subtle data tinting for faster scanning (tables only).
     We keep it neutral so feature-specific accents (USD/LBP/status) can override cleanly. */
  .ui-table td.data-mono,
  .ui-table td .data-mono {
    color: rgb(var(--fg));
  }

  /* Optional semantic accents (keep subtle; used intentionally in tables). */
  .ui-tone-usd {
    color: rgb(var(--info));
    font-weight: 600;
    font-size: 0.95rem;
  }

  .ui-tone-lbp {
    color: rgb(var(--terminal-cyan));
    font-weight: 600;
    font-size: 0.95rem;
  }

  /* Enforce readable monetary typography in dense table cells, even if legacy text-xs remains. */
  .ui-table td.ui-tone-usd,
  .ui-table td.ui-tone-lbp,
  .ui-table td .ui-tone-usd,
  .ui-table td .ui-tone-lbp {
    font-size: 0.95rem;
    font-weight: 600;
  }

  .ui-tone-qty {
    color: rgb(var(--success));
  }

  .ui-tone-negative {
    color: rgb(var(--danger));
  }

  .ui-table tbody tr:last-child {
    @apply border-b-0;
  }

  /* Tab bars: quick navigation within a module (e.g. System settings). */
  .ui-tabbar-wrap {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  .ui-tabbar {
    display: inline-flex;
    min-width: max-content;
    gap: 6px;
    padding: 6px;
    border-radius: 999px;
    border: 1px solid rgb(var(--border-subtle));
    background: rgb(var(--bg-sunken) / 0.25);
  }
  .ui-tabbar-tab {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    height: 32px;
    padding: 0 12px;
    border-radius: 999px;
    font-size: 13px;
    color: rgb(var(--fg-muted));
    text-decoration: none;
    transition: background 120ms ease, color 120ms ease, box-shadow 120ms ease;
    white-space: nowrap;
  }
  .ui-tabbar-tab:hover {
    background: rgb(var(--bg-elevated) / 0.6);
    color: rgb(var(--foreground));
  }
  .ui-tabbar-tab-active {
    background: rgb(var(--bg-elevated));
    color: rgb(var(--foreground));
    box-shadow: 0 1px 0 rgb(0 0 0 / 0.05), 0 0 0 1px rgb(var(--border));
  }

  /* Date inputs: make calendar pickers feel consistent and readable */
  input[type="date"] {
    @apply data-mono;
    /* Keep text clear of the native calendar icon (esp. WebKit). */
    padding-right: 2.5rem;
    /* Use our own calendar glyph so date inputs look consistent across pages/browsers. */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='rgb(161,161,170)' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M8 2v4'/%3E%3Cpath d='M16 2v4'/%3E%3Crect width='18' height='18' x='3' y='4' rx='2'/%3E%3Cpath d='M3 10h18'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: calc(100% - 0.75rem) center;
  }

  /* WebKit: normalize date field text color/spacing across pages */
  input[type="date"]::-webkit-datetime-edit {
    color: rgb(var(--fg));
  }

  input[type="date"]::-webkit-datetime-edit-fields-wrapper {
    padding: 0;
  }

  input[type="date"]::-webkit-inner-spin-button,
  input[type="date"]::-webkit-clear-button {
    display: none;
  }

  input[type="date"]::-webkit-calendar-picker-indicator {
    /* Keep the click target, but hide the inconsistent native icon (we render our own). */
    opacity: 0;
    cursor: pointer;
  }

  input[type="date"]:hover::-webkit-calendar-picker-indicator,
  input[type="date"]:focus-visible::-webkit-calendar-picker-indicator {
    opacity: 0;
  }

  /* When we render a custom calendar icon button, hide the native indicator (to avoid double icons). */
  input[type="date"].ui-date::-webkit-calendar-picker-indicator {
    opacity: 0;
  }

  input[type="date"].ui-date {
    background-image: none;
  }

  /* Keyboard shortcuts */
  .ui-kbd {
    @apply inline-flex items-center justify-center rounded px-1.5 py-0.5 text-xs font-mono font-medium;
    @apply bg-bg-elevated text-fg-muted border border-border;
    box-shadow: 0 1px 0 rgb(var(--border-strong));
  }

  /* Chips/Tags */
  .ui-chip {
    @apply inline-flex items-center gap-1.5 rounded-md px-2.5 py-1 text-xs font-medium;
  }

  .ui-chip-default {
    @apply border border-border bg-bg-elevated text-fg-muted;
  }

  .ui-chip-primary {
    @apply border border-primary/20 bg-primary/5 text-foreground;
  }

  .ui-chip-success {
    @apply border border-success/20 bg-success/5 text-foreground;
  }

  .ui-chip-warning {
    @apply border border-warning/25 bg-warning/5 text-foreground;
  }

  .ui-chip-danger {
    @apply border border-danger/25 bg-danger/5 text-foreground;
  }

  /* Status indicators */
  .status-dot {
    @apply h-2 w-2 rounded-full;
  }

  .status-online {
    @apply bg-success;
    box-shadow: 0 0 8px rgb(var(--success) / 0.45);
  }

  .status-offline {
    @apply bg-danger;
  }

  .status-warning {
    @apply bg-warning;
  }

  /* Table row state highlights with a left accent for non-color-only scanning. */
  .ui-row-warning {
    @apply bg-warning/5;
    box-shadow: inset 3px 0 0 rgb(var(--warning) / 0.55);
  }

  .ui-row-danger {
    @apply bg-danger/5;
    box-shadow: inset 3px 0 0 rgb(var(--danger) / 0.6);
  }

  .ui-row-success {
    @apply bg-success/5;
    box-shadow: inset 3px 0 0 rgb(var(--success) / 0.55);
  }

  /* Section dividers */
  .section-divider {
    @apply h-px bg-gradient-to-r from-transparent via-border-strong to-transparent;
  }

  /* Glass panel for overlays */
  .glass-panel {
    @apply bg-bg-elevated/80 backdrop-blur-xl border border-border-subtle;
  }

  /* Data grid cells */
  .data-cell {
    @apply data-mono text-fg-muted;
  }

  .data-cell-positive {
    @apply text-success;
  }

  .data-cell-negative {
    @apply text-danger;
  }

  .data-cell-highlight {
    @apply text-primary;
  }

  /* Card variations */
  .card-interactive {
    @apply transition-all duration-200;
    @apply hover:border-border-strong hover:shadow-lg hover:shadow-black/10;
  }
}

@layer utilities {
  /*
    Token Compatibility Shim
    Some pages still use hardcoded Tailwind slate/white utilities. Override the most common ones
    so they follow our design tokens and stay correct in dark mode.
  */

  /* Backgrounds */
  .bg-white {
    background-color: rgb(var(--bg-elevated));
  }
  .bg-white\/60 {
    background-color: rgb(var(--bg-elevated) / 0.6);
  }
  .bg-white\/80 {
    background-color: rgb(var(--bg-elevated) / 0.8);
  }

  .bg-slate-50 {
    background-color: rgb(var(--bg-sunken) / 0.35);
  }
  .bg-slate-100 {
    background-color: rgb(var(--bg-sunken) / 0.55);
  }

  .hover\:bg-slate-50:hover {
    background-color: rgb(var(--bg-sunken) / 0.45);
  }

  /* Borders */
  .border-slate-100 {
    border-color: rgb(var(--border-subtle));
  }
  .border-slate-200 {
    border-color: rgb(var(--border-subtle));
  }
  .border-slate-300 {
    border-color: rgb(var(--border));
  }

  /* Text */
  .text-slate-950,
  .text-slate-900,
  .text-slate-800 {
    color: rgb(var(--fg));
  }
  .text-slate-700,
  .text-slate-600 {
    color: rgb(var(--fg-muted));
  }
  .text-slate-500,
  .text-slate-400 {
    color: rgb(var(--fg-subtle));
  }
}

@layer utilities {
  /* Animation utilities */
  .animate-fade-in {
    animation: fadeIn 0.2s ease-out;
  }

  .animate-slide-in-right {
    animation: slideInRight 0.2s ease-out;
  }

  .animate-pulse-subtle {
    animation: pulseSubtle 2s ease-in-out infinite;
  }

  /* Text utilities */
  .text-balance {
    text-wrap: balance;
  }

  /* Gradient text */
  .text-gradient {
    @apply bg-gradient-to-r from-primary to-primary-dim bg-clip-text text-transparent;
  }

  /* Focus ring */
  .focus-ring {
    @apply focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-background;
  }

  /* Links that should look like "actions" in dense tables/forms */
  .ui-link {
    @apply relative inline-flex items-center gap-1 text-primary underline-offset-4 hover:underline focus-ring;
  }

  /* "Shortcut" links: look like normal text until hover/focus, then show link styling + arrow. */
  .ui-shortcut {
    @apply relative inline-flex items-center gap-1 rounded-sm px-1 -mx-1 text-foreground underline-offset-4 hover:text-primary hover:underline focus-ring;
  }

  /* Hover affordance: arrow appears only on hover/focus (keep the UI calm by default). */
  .ui-link::after,
  .ui-shortcut::after {
    /* Use a literal arrow instead of a CSS escape to avoid any odd rendering in some environments. */
    content: "→";
    display: inline-block;
    /* Reserve space to avoid layout shift on hover, but keep it in-flow so it can't overlap text. */
    width: 1.1em;
    margin-left: 0.25rem;
    text-align: center;
    opacity: 0;
    transform: translateX(-2px);
    transition:
      opacity 150ms ease,
      transform 150ms ease;
    pointer-events: none;
  }

  .ui-link:hover::after,
  .ui-link:focus-visible::after,
  .ui-shortcut:hover::after,
  .ui-shortcut:focus-visible::after {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* ------------------------------------------------------------
   Print / PDF (browser print dialog)
   ------------------------------------------------------------ */

/* Use on elements that should never appear in print/PDF. */
@media print {
  .no-print {
    display: none !important;
  }

  /* Force a neutral paper look even if the UI is in dark mode. */
  html,
  body {
    background: #fff !important;
    color: #000 !important;
  }

  /* Links should not show as blue/underlined on official documents. */
  a {
    color: inherit !important;
    text-decoration: none !important;
  }

  /* Make table headers repeat across pages. */
  thead {
    display: table-header-group;
  }
  tfoot {
    display: table-footer-group;
  }
}

/* Default page settings (most printers support A4; browsers will map if needed). */
@page {
  size: A4;
  margin: 12mm;
}

/* Use for the paper container (works both on-screen and in print). */
.print-paper {
  background: #fff;
  color: #000;
}

/* Thermal-style receipt container for on-screen preview; @page sizing is handled per-page via injected CSS. */
.print-receipt {
  max-width: 80mm;
}

@keyframes pulseSubtle {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}
