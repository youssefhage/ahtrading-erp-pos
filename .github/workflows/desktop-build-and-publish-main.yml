name: Desktop build & publish (main)

on:
  workflow_dispatch:
  push:
    branches: [main]
    paths:
      - "apps/pos-desktop/**"
      - "apps/admin-desktop/**"
      - "apps/setup-desktop/**"
      - "apps/downloads/**"
      - "backend/app/routers/updates.py"
      - "backend/app/static/downloads_site/**"
      - "scripts/publish_desktop_release.py"
      - ".github/workflows/desktop-build-and-publish-*.yml"

concurrency:
  group: desktop-publish-main-${{ github.ref }}
  cancel-in-progress: true

jobs:
  run:
    uses: ./.github/workflows/desktop-build-and-publish-reusable.yml
    secrets: inherit
